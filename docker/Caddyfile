{
    # Admin API on port 2019 (internal to Docker network only, not host-exposed)
    admin :2019

    # Dev stack: no TLS. Production uses xcord-topo-generated Caddyfiles
    # with real ACME certs and security headers.
    auto_https off
}

# Hub domain only â€” serves the gateway API and hub SPA.
# Instance routes are added dynamically via the Caddy Admin API by the gateway
# provisioner after each instance container is started.
http://{$HUB_DOMAIN:localhost} {
    reverse_proxy gateway:80

    log {
        output stdout
        format console
    }
}

http://mail.{$HUB_DOMAIN:localhost} {
    reverse_proxy mailpit:8025
}
